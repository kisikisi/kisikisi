var config=["$stateProvider","$httpProvider","$urlRouterProvider","$authProvider","$locationProvider","envServiceProvider","ezfbProvider",function(i,e,a,d,s,t,r){i.state("agenda",{url:"/",controller:"agendaIndexCtrl",templateUrl:"views/agenda/agenda.list.html"}).state("agendaDetail",{url:"/{id:[a-zA-Z1-9.-]*}",controller:"agendaDetailCtrl",templateUrl:"views/agenda/agenda.detail.html"}),t.config({domains:{development:["localhost","kisikisi.dev","agenda.kisikisi.dev"],production:["103.11.74.10","kisikisi.id","agenda.kisikisi.id"]},vars:{development:{site:"//kisikisi.dev/",api:"//api.kisikisi.dev/",file:"//files.kisikisi.dev/",agenda:"//agenda.kisikisi.dev/"},production:{site:"//kisikisi.id/",api:"//api.kisikisi.id/",agenda:"//agenda.kisikisi.id/",file:"//files.kisikisi.id/"}}}),t.check(),s.html5Mode(!0),a.otherwise("/"),d.loginUrl="/login",r.setInitParams({appId:"135688693164869"})}];
var agendaDetailCtrl=["$http","$scope","$location","$sce","$stateParams","Notification",function(t,e,a,i,d,n){t.get(e.env.api+"agenda/"+d.id).success(function(t){e.detail=t.detail,e.detail.content=i.trustAsHtml(t.detail.content),e.detail.map_address=i.trustAsResourceUrl(t.detail.map_address),e.detail.start=moment.unix(t.detail.start_datetime).format("MM/DD/YYYY"),e.detail.end=moment.unix(t.detail.end_datetime).format("MM/DD/YYYY"),e.onDetail=!0})}];
var agendaIndexCtrl=["$http","$scope","$rootScope","$location","Notification","envService",function(o,t,e,n,c,i){}];
var agendaCtrl=["$http","$scope","$rootScope","$state","$auth","$sce","$location","Notification","envService",function(e,a,t,n,o,s,r,l,c){t.env=c.read("all"),a.agendas=[],a.scrollBusy=!1,a.limit=12,a.after=0,a.onSearch=!1,a.filter={},a.url=r.absUrl(),null==o.getToken()&&o.setToken(),a.$on("$includeContentLoaded",function(e){a.modal1=$("#siteModal").modal(),a.modal2=$("#basicModal").modal()}),a.indexSearch=function(e,a){return e.map(function(e){return e.id}).indexOf(a)},a.toggleSearch=function(){0==a.onSearch?a.onSearch=!0:a.onSearch=!1},a.filterAgenda=function(){e.get(a.env.api+"agenda/form").success(function(e){a.agendaCategories=e.agendaCategories,a.cities=e.cities,a.provinces=e.provinces})},a.filterAgenda(),a.searchAgenda=function(e){a.after=0,a.agendas=[],a.nextPage(),a.filter=e,a.onSearch=!1,n.go("agenda")},a.agendaCalendar=function(){e.get(a.env.api+"agenda/calendar").success(function(e){var t=e.calendar;for(i=0;i<t.length;i++)t[i].start=moment.unix(e.calendar[i].start).format("YYYY-MM-DD"),t[i].end=moment.unix(e.calendar[i].end).format("YYYY-MM-DD");a.eventSources={events:t,color:"yellow",textColor:"black"}})},a.agendaCalendar(),a.nextPage=function(){a.scrollBusy=!0,e.get(a.env.api+"agenda/scroll/"+a.after+"/"+a.limit,{params:a.filter}).success(function(e){for(var t=0;t<e.agendas.length;t++)a.agendas.push(e.agendas[t]);e.agendas.length>0&&(a.after=e.agendas[e.agendas.length-1].id,a.scrollBusy=!1)})},a.detailAgenda=function(t){e.get(a.env.api+"agenda/"+t).success(function(e){a.detail=e.detail,a.detail.content=s.trustAsHtml(e.detail.content),a.detail.map_address=s.trustAsResourceUrl(e.detail.map_address),a.detail.start=moment.unix(e.detail.start_datetime).format("MM/DD/YYYY"),a.detail.end=moment.unix(e.detail.end_datetime).format("MM/DD/YYYY"),a.modal1.modal("show")})},a.smallModal="views/partial/login.html",a.loginForm=function(){a.smallModal="views/partial/login.html",a.modal2.modal("show")},a.registerPage=function(){a.smallModal="views/partial/register.html"},a.getAuthUser=function(){e.get(a.env.api+"auth/user").success(function(e){t.auth=e.user,a.popup()})},a.authenticate=function(e){o.authenticate(e).then(function(e){a.getAuthUser(),a.modal2.hide()})["catch"](function(e){e.error?l({message:e.error},"error"):e.data?l({message:e.data.message},e.status):l({message:e},"error")})},a.login=function(e){o.login(e).then(function(e){a.modal2.modal("hide"),a.getAuthUser()})["catch"](function(e){l({message:e.data.message},e.data.status)})},a.register=function(e){o.signup(e).then(function(e){o.setToken(e),a.getAuthUser(),a.modal2.modal("hide"),l({message:"Pendaftaran berhasil, terima kasih"},"success")})["catch"](function(e){l({message:e.data.message},e.status)})},a.isLogin=function(){return o.isAuthenticated()},a.logout=function(){o.logout(),a.loginForm()},a.isLogin()&&a.getAuthUser();var d=this;a.$watch(function(){return d.href},function(){d.rendered=!1})}];
app=angular.module("kisiApp",["ui.router","ngSanitize","satellizer","ngTouch","superswipe","environment","ui-notification","ngTagsInput","ezfb","infinite-scroll","ui.calendar"]),app.config(config).controller("agendaCtrl",agendaCtrl).controller("agendaIndexCtrl",agendaIndexCtrl).controller("agendaDetailCtrl",agendaDetailCtrl).directive("uiRating",function(){return function(n,i,e){$(i).rating()}}).directive("uiTab",function(){return function(n,i,e){$(i).tab()}}).directive("uiSidebar",function(){return function(n,i,e){$(i).sidebar("toggle"),$(i).sidebar("attach events",e.trigger)}}).directive("uiDropdown",function(){return function(n,i,e){$(i).dropdown({keepOnScreen:!1})}}).directive("uiAccordion",function(){return function(n,i,e){$(i).accordion()}});
