var config=["$stateProvider","$httpProvider","$urlRouterProvider","$authProvider","$locationProvider","envServiceProvider","ezfbProvider",function(i,e,r,s,o,d,t){i.state("school",{url:"/",controller:"dirIndexCtrl",templateUrl:"views/directory/school.list.html"}).state("schoolDetail",{url:"/{id:[a-zA-Z1-9.-]*}",controller:"dirDetailCtrl",templateUrl:"views/directory/school.detail.html"}),d.config({domains:{development:["localhost","kisikisi.dev","dir.kisikisi.dev"],production:["103.11.74.10","kisikisi.id","dir.kisikisi.id"]},vars:{development:{site:"//kisikisi.dev/",api:"//api.kisikisi.dev/",file:"//files.kisikisi.dev/",dir:"//dir.kisikisi.dev/"},production:{site:"//kisikisi.id/",api:"//api.kisikisi.id/",dir:"//dir.kisikisi.id/",file:"//files.kisikisi.id/"}}}),d.check(),o.html5Mode(!0),r.otherwise("/"),s.loginUrl="/login",t.setInitParams({appId:"135688693164869"})}];
var dirDetailCtrl=["$http","$scope","$location","$sce","$stateParams","Notification",function(t,a,i,e,s,d){t.get(a.env.api+"school/"+s.id).success(function(t){a.detail=t.detail[0],a.detail.description=e.trustAsHtml(t.detail[0].description),a.detail.data=e.trustAsHtml(t.detail[0].data),a.detail.map_address=e.trustAsResourceUrl(t.detail[0].map_address),a.onDetail=!0})}];
var dirIndexCtrl=["$http","$scope","$rootScope","$location","Notification","envService",function(o,t,i,c,e,n){}];
var dirCtrl=["$http","$scope","$rootScope","$sce","$location","Notification","envService",function(o,e,t,c,s,l,n){t.env=n.read("all"),e.schools=[],e.scrollBusy=!1,e.limit=12,e.after=0,e.onSearch=!1,e.filter={},e.$on("$includeContentLoaded",function(o){e.modal1=$("#siteModal").modal(),e.modal2=$("#basicModal").modal()}),e.indexSearch=function(o,e){return o.map(function(o){return o.id}).indexOf(e)},e.toggleSearch=function(){0==e.onSearch?e.onSearch=!0:e.onSearch=!1},e.filterSchool=function(){o.get(e.env.api+"school/form").success(function(o){e.schoolTypes=o.schoolTypes,e.cities=o.cities,e.provinces=o.provinces})},e.filterSchool(),e.searchSchool=function(o){e.after=0,e.schools=[],e.nextPage(),e.filter=o,e.onSearch=!1},e.nextPage=function(){e.scrollBusy=!0,o.get(e.env.api+"school/scroll/"+e.after+"/"+e.limit,{params:e.filter}).success(function(o){for(var t=0;t<o.schools.length;t++)e.schools.push(o.schools[t]);o.schools.length>0&&(e.after=o.schools[o.schools.length-1].id,e.scrollBusy=!1)})},e.loginForm=function(){e.modal2.modal("show")},e.detailSchool=function(t){o.get(e.env.api+"school/"+t).success(function(o){e.detail=o.detail[0],e.detail.description=c.trustAsHtml(o.detail[0].description),e.detail.data=c.trustAsHtml(o.detail[0].data),e.detail.map_address=c.trustAsResourceUrl(o.detail[0].map_address),e.modal1.modal("show")})};var i=this;e.$watch(function(){return i.href},function(){i.rendered=!1})}];
app=angular.module("kisiDirApp",["ui.router","ngSanitize","satellizer","ngTouch","superswipe","environment","ui-notification","ngTagsInput","ezfb","infinite-scroll"]),app.config(config).controller("dirCtrl",dirCtrl).controller("dirIndexCtrl",dirIndexCtrl).controller("dirDetailCtrl",dirDetailCtrl).directive("uiRating",function(){return function(i,n,r){$(n).rating()}}).directive("uiTab",function(){return function(i,n,r){$(n).tab()}}).directive("uiSidebar",function(){return function(i,n,r){$(n).sidebar("toggle"),$(n).sidebar("attach events",r.trigger)}}).directive("uiDropdown",function(){return function(i,n,r){$(n).dropdown({keepOnScreen:!1})}}).directive("uiAccordion",function(){return function(i,n,r){$(n).accordion()}});
