var kisiCtrl=["$scope","$rootScope","$http","$auth","$state","envService",function(t,n,e,i,u,o){n.env=o.read("all"),t.isAuthenticated=function(){return i.isAuthenticated()},t.logout=function(){i.logout(),u.go("login")},t.indexSearch=function(t,n){return t.map(function(t){return t.id}).indexOf(n)},t.getAuthUser=function(){e.get(t.env.api+"auth/user").success(function(e){n.auth=e.user,t.popup()})},t.isLogin=function(){return i.isAuthenticated()},t.isLogin()&&t.getAuthUser()}];
var agendaCatCtrl=["$http","$scope","Notification",function(e,a,t){$.AdminLTE.layout.fix(),a.currentPage=1,a.limit=10,a.categories=[],a.totalCategories=0,a.limit=20,a.after=0,a.scrollBusy=!1,a.scrollLast=!1,a.nextPage=function(){a.scrollBusy=!0,e.get(a.env.api+"agenda/category/scroll/"+a.after+"/"+a.limit,{params:a.filter}).success(function(e){for(var t=0;t<e.categories.length;t++)a.categories.push(e.categories[t]);e.categories.length>0?a.after=e.categories[e.categories.length-1].id:a.scrollLast=!0,a.scrollBusy=!1})},a.addCategory=function(s){a.onAdd=!0,e.post(a.env.api+"agenda/category",s).success(function(e){t({message:e.message},e.status),"success"==e.status&&(a.categories.push(e.category),a.input={},$("#name").focus()),a.onAdd=!1})},a.saveCategory=function(s,o){a.onLoad=!0,e.put(a.env.api+"agenda/category/"+o,s).success(function(e){t({message:e.data.message},e.status),a.onLoad=!1})},a.deleteCategory=function(s){var o=a.indexSearch(a.type,s);confirm("delete agenda category?")&&(a.onLoad=!0,e["delete"](a.env.api+"agenda/category/"+s).success(function(e){t({message:e.message},e.status),"success"==e.status&&a.categories.splice(o,1),a.onLoad=!1}))}}];
var agendaCtrl=["$http","$scope","$location","Upload","Notification",function(e,a,n,t,s){$.AdminLTE.layout.fix(),a.onEdit=!1,a.input={},a.agendaForm={},a.agendas=[],a.totalAgendas=0,a.limit=20,a.after=0,a.scrollBusy=!1,a.scrollLast=!1,a.searchAgenda=function(e){a.after=0,a.agenda=[],a.nextPage(),a.filter=e},a.nextPage=function(){a.scrollBusy=!0,e.get(a.env.api+"agenda/scroll/"+a.after+"/"+a.limit,{params:a.filter}).success(function(e){for(var n=0;n<e.agendas.length;n++)a.agendas.push(e.agendas[n]),a.agendas[n].start=moment.unix(e.agendas[n].start_datetime).format("MM/DD/YYYY"),a.agendas[n].end=moment.unix(e.agendas[n].end_datetime).format("MM/DD/YYYY");e.agendas.length>0?a.after=e.agendas[e.agendas.length-1].id:a.scrollLast=!0,a.scrollBusy=!1})},a.formAgenda=function(){e.get(a.env.api+"agenda/form").success(function(e){a.labels=e.labels,a.agendaCategories=e.agendaCategories,a.cities=e.cities,a.provinces=e.provinces})},a.slug=function(e){return e=e.replace(/[^a-zA-Z0-9\s]/g,""),e=e.toLowerCase(),e=e.replace(/\s/g,"-")},a.loadLabels=function(e){return a.labels},a.addLabel=function(n,t){e.post(a.env.api+"agenda/"+t+"/label/"+n.id).success(function(e){return"success"==e.status})},a.removeLabel=function(n,t){return!!confirm("remove label?")&&void e["delete"](a.env.api+"agenda/"+t+"/label/"+n.id).success(function(e){if("success"==e.status)return!0})},a.uploadCover=function(e,n){e&&(a.onProgress1=!0,t.upload({url:a.env.api+"agenda/cover",method:"POST",data:{image:n}}).then(function(e){a.onProgress1=!1,a.input.image_cover=e.data.cover},function(e){s({message:e.message},e.status)},function(e){var n=parseInt(100*e.loaded/e.total);a.progress1=n}))},a.uploadContent=function(e,n){e&&(a.onProgress2=!0,t.upload({url:a.env.api+"agenda/content",method:"POST",data:{image:n}}).then(function(e){a.onProgress2=!1,a.input.image_content=e.data.content},function(e){s({message:e.message},e.status)},function(e){var n=parseInt(100*e.loaded/e.total);a.progress2=n}))},a.resetAgenda=function(){a.input={},$("[data-widget='collapse']").click()},a.saveAgenda=function(n){if(a.onSave=!0,void 0==n.id)e.post(a.env.api+"agenda",n).success(function(e){s({message:e.message},e.status),"success"==e.status&&(a.agendas.push(e.agenda),a.input.id=e.agenda.id),a.onSave=!1});else{var t=a.indexSearch(a.agendas,n.id);e.put(a.env.api+"agenda/"+n.id,n).then(function(e){a.agendas[t]=e.data.agenda[0],s({message:e.data.message},e.data.status),a.onSave=!1})}},a.editAgenda=function(t){e.get(a.env.api+"agenda/"+t).success(function(e){a.input=e.detail,a.input.start_datetime=moment.unix(e.detail.start_datetime).format("MM/DD/YYYY"),a.input.end_datetime=moment.unix(e.detail.end_datetime).format("MM/DD/YYYY"),a.input.province_id=e.detail.city.province_id,a.input.agenda_label=e.agendaLabel,a.input.agenda_category_id=parseInt(a.input.agenda_category_id),a.input.status=parseInt(a.input.status),$(".box.box-default").hasClass("collapsed-box")&&$("[data-widget='collapse']").click(),n.hash("agendaForm")})},a.deleteAgenda=function(n){var t=a.indexSearch(a.agendas,n);confirm("delete agenda?")&&(a.onLoad=!0,e["delete"](a.env.api+"agenda/"+n).success(function(e){s({message:e.message},e.status),"success"==e.status&&a.agendas.splice(t,1),a.onLoad=!1}))},a.formAgenda()}];
var authCtrl=["$scope","$auth","$state","Notification",function(n,o,t,s){n.onLogin=!1,n.login=function(a){n.onLogin=!0,o.login(a).then(function(o){n.getAuthUser(),t.go("dashboard"),s({message:"login success"},"success"),n.onLogin=!1})["catch"](function(o){s({message:o.data.message},o.data.status),n.onLogin=!1})}}];
var config=["$stateProvider","$httpProvider","$urlRouterProvider","$authProvider","$locationProvider","envServiceProvider",function(e,l,i,r,t,o){var s=["$q","$location","$auth",function(e,l,i){var r=e.defer();return i.isAuthenticated()?r.resolve():l.path("/login"),r.promise}],a=["$q","$auth",function(e,l){var i=e.defer();return l.isAuthenticated()?i.reject():i.resolve(),i.promise}];e.state("dashboard",{url:"/",templateUrl:"views/admin/dashboard.html",controller:"homeCtrl",resolve:{loginRequired:s}}).state("school",{url:"/school",templateUrl:"views/admin/school.html",controller:"schoolCtrl",resolve:{loginRequired:s}}).state("school-type",{url:"/school/type",templateUrl:"views/admin/school.type.html",controller:"schoolTypeCtrl",resolve:{loginRequired:s}}).state("login",{url:"/login",templateUrl:"views/admin/login.html",controller:"authCtrl",resolve:{skipIfLoggedIn:a}}).state("label",{url:"/label",templateUrl:"views/admin/label.html",controller:"labelCtrl",resolve:{loginRequired:s}}).state("news",{url:"/news",templateUrl:"views/admin/news.html",controller:"newsCtrl",resolve:{loginRequired:s}}).state("news-category",{url:"/news/category",templateUrl:"views/admin/news.category.html",controller:"newsCatCtrl",resolve:{loginRequired:s}}).state("agenda",{url:"/agenda",templateUrl:"views/admin/agenda.html",controller:"agendaCtrl",resolve:{loginRequired:s}}).state("agenda-category",{url:"/agenda/category",templateUrl:"views/admin/agenda.category.html",controller:"agendaCatCtrl",resolve:{loginRequired:s}}).state("scholarship",{url:"/scholarship",templateUrl:"views/admin/scholarship.html",controller:"scholarshipCtrl",resolve:{loginRequired:s}}).state("course",{url:"/course",templateUrl:"views/admin/course.html",controller:"courseCtrl",resolve:{loginRequired:s}}).state("user",{url:"/user",templateUrl:"views/admin/user.html",controller:"userCtrl",resolve:{loginRequired:s}}),o.config({domains:{development:["localhost","kisikisi.dev","setup.kisikisi.dev"],production:["103.11.74.10","kisikisi.id","setup.kisikisi.id"]},vars:{development:{site:"//kisikisi.dev/",api:"//api.kisikisi.dev/",admin:"//setup.kisikisi.dev/",file:"//files.kisikisi.dev/"},production:{site:"//kisikisi.id/",api:"//api.kisikisi.id/",admin:"//setup.kisikisi.id/",file:"//files.kisikisi.id/"}}}),o.check(),t.html5Mode(!0),i.otherwise("/"),r.loginUrl="/login/setup"}];
var courseCtrl=["$http","$scope","$location","Upload","Notification",function(e,s,o,t,c){$.AdminLTE.layout.fix(),s.onEdit=!1,s.input={},s.courseForm={},s.courses=[],s.totalCourses=0,s.limit=20,s.after=0,s.scrollBusy=!1,s.scrollLast=!1,s.searchCourse=function(e){s.after=0,s.course=[],s.nextPage(),s.filter=e},s.nextPage=function(){s.scrollBusy=!0,e.get(s.env.api+"course/scroll/"+s.after+"/"+s.limit,{params:s.filter}).success(function(e){for(var o=0;o<e.courses.length;o++)s.courses.push(e.courses[o]);e.courses.length>0?s.after=e.courses[e.courses.length-1].id:s.scrollLast=!0,s.scrollBusy=!1})},s.formCourse=function(){e.get(s.env.api+"course/form").success(function(e){s.labels=e.labels})},s.slug=function(e){return e=e.replace(/[^a-zA-Z0-9\s]/g,""),e=e.toLowerCase(),e=e.replace(/\s/g,"-")},s.loadLabels=function(e){return s.labels},s.addLabel=function(o,t){e.post(s.env.api+"course/"+t+"/label/"+o.id).success(function(e){return"success"==e.status})},s.removeLabel=function(o,t){return!!confirm("remove label?")&&void e["delete"](s.env.api+"course/"+t+"/label/"+o.id).success(function(e){if("success"==e.status)return!0})},s.uploadCover=function(e,o){e&&(s.onProgress1=!0,t.upload({url:s.env.api+"course/cover",method:"POST",data:{image:o}}).then(function(e){s.onProgress1=!1,s.input.image_cover=e.data.cover},function(e){c({message:e.message},e.status)},function(e){var o=parseInt(100*e.loaded/e.total);s.progress1=o}))},s.resetCourse=function(){s.input={},$("[data-widget='collapse']").click()},s.saveCourse=function(o){if(s.onSave=!0,void 0==o.id)e.post(s.env.api+"course",o).success(function(e){c({message:e.message},e.status),"success"==e.status&&(s.courses.push(e.course),s.input.id=e.course.id),s.onSave=!1});else{var t=s.indexSearch(s.courses,o.id);e.put(s.env.api+"course/"+o.id,o).then(function(e){s.courses[t]=e.data.course[0],c({message:e.data.message},e.data.status),s.onSave=!1})}},s.editCourse=function(t){e.get(s.env.api+"course/"+t).success(function(e){s.input=e.detail,$(".box.box-default").hasClass("collapsed-box")&&$("[data-widget='collapse']").click(),o.hash("courseForm")})},s.deleteCourse=function(o){var t=s.indexSearch(s.courses,o);confirm("delete course?")&&(s.onLoad=!0,e["delete"](s.env.api+"course/"+o).success(function(e){c({message:e.message},e.status),"success"==e.status&&s.courses.splice(t,1),s.onLoad=!1}))},s.formCourse()}];
var homeCtrl=["$scope","$http",function(t,n){$.AdminLTE.layout.fix(),n.get(t.env.api+"dashboard").success(function(n){t.count=n})}];
var labelCtrl=["$http","$scope","Notification",function(e,s,a){$.AdminLTE.layout.fix(),s.currentPage=1,s.limit=10,s.listLabel=function(){e.get(s.env.api+"label").success(function(e){s.labels=e.labels})},s.addLabel=function(l){e.post(s.env.api+"label",l).success(function(e){a({message:e.message},e.status),"success"==e.status&&(s.labels.push(e.label),s.input={},$("#name").focus())})},s.saveLabel=function(a,l){return e.put(s.env.api+"label/"+l,a)},s.deleteLabel=function(l){var t=s.indexSearch(s.labels,l);confirm("delete label?")&&e["delete"](s.env.api+"label/"+l).success(function(e){a({message:e.message},e.status),"success"==e.status&&s.labels.splice(t,1)})},s.listLabel()}];
var newsCatCtrl=["$http","$scope","Notification",function(e,s,t){$.AdminLTE.layout.fix(),s.onEdit=!1,s.input={},s.categories=[],s.totalCategories=0,s.limit=20,s.after=0,s.scrollBusy=!1,s.scrollLast=!1,s.nextPage=function(){s.scrollBusy=!0,e.get(s.env.api+"news/category/scroll/"+s.after+"/"+s.limit,{params:s.filter}).success(function(e){for(var t=0;t<e.categories.length;t++)s.categories.push(e.categories[t]);e.categories.length>0?s.after=e.categories[e.categories.length-1].id:s.scrollLast=!0,s.scrollBusy=!1})},s.addCategory=function(a){s.onAdd=!0,e.post(s.env.api+"news/category",a).success(function(e){t({message:e.message},e.status),"success"==e.status&&(s.categories.push(e.category),s.input={},$("#name").focus()),s.onAdd=!1})},s.saveCategory=function(a,o){return e.put(s.env.api+"news/category/"+o,a).success(function(e){t({message:e.data.message},e.status)})},s.deleteCategory=function(a){var o=s.indexSearch(s.type,a);confirm("delete news category?")&&(s.onLoad=!0,e["delete"](s.env.api+"news/category/"+a).success(function(e){t({message:e.message},e.status),"success"==e.status&&s.categories.splice(o,1),s.onLoad=!1}))}}];
var newsCtrl=["$http","$scope","$location","Upload","Notification",function(e,s,n,t,a){$.AdminLTE.layout.fix(),s.onEdit=!1,s.input={},s.schoolAddForm={},s.news=[],s.totalNews=0,s.limit=20,s.after=0,s.scrollBusy=!1,s.scrollLast=!1,s.searchNews=function(e){s.after=0,s.news=[],s.nextPage(),s.filter=e},s.nextPage=function(){s.scrollBusy=!0,e.get(s.env.api+"news/scroll/"+s.after+"/"+s.limit,{params:s.filter}).success(function(e){for(var n=0;n<e.news.length;n++)s.news.push(e.news[n]);e.news.length>0?s.after=e.news[e.news.length-1].id:s.scrollLast=!0,s.scrollBusy=!1})},s.formNews=function(){e.get(s.env.api+"news/form").success(function(e){s.labels=e.labels,s.newsCategories=e.newsCategories})},s.slug=function(e){return e=e.replace(/[^a-zA-Z0-9\s]/g,""),e=e.toLowerCase(),e=e.replace(/\s/g,"-")},s.loadLabels=function(e){return s.labels},s.addLabel=function(n,t){e.post(s.env.api+"news/"+t+"/label/"+n.id).success(function(e){return"success"==e.status})},s.removeLabel=function(n,t){return!!confirm("remove label?")&&void e["delete"](s.env.api+"news/"+t+"/label/"+n.id).success(function(e){if("success"==e.status)return!0})},s.uploadCover=function(e,n){e&&(s.onProgress1=!0,t.upload({url:s.env.api+"news/cover",method:"POST",data:{image:n}}).then(function(e){s.onProgress1=!1,s.input.image_cover=e.data.cover},function(e){a({message:e.message},e.status)},function(e){var n=parseInt(100*e.loaded/e.total);s.progress1=n}))},s.uploadContent=function(e,n){e&&(s.onProgress2=!0,t.upload({url:s.env.api+"news/content",method:"POST",data:{image:n}}).then(function(e){s.onProgress2=!1,s.input.image_content=e.data.content},function(e){a({message:e.message},e.status)},function(e){var n=parseInt(100*e.loaded/e.total);s.progress2=n}))},s.resetNews=function(){s.input={},$("[data-widget='collapse']").click()},s.saveNews=function(n){if(s.onSave=!0,void 0==n.id)e.post(s.env.api+"news",n).success(function(e){a({message:e.message},e.status),"success"==e.status&&(s.news.push(e.news),s.input.id=e.news.id),s.onSave=!1});else{var t=s.indexSearch(s.news,n.id);n.author=n.author.id,e.put(s.env.api+"news/"+n.id,n).then(function(e){s.news[t]=e.data.news[0],a({message:e.data.message},e.data.status),s.onSave=!1})}},s.editNews=function(t){e.get(s.env.api+"news/"+t).success(function(e){s.input=e.detail,s.input.date=moment.unix(e.detail.date).format("MM/DD/YYYY"),s.input.news_label=e.newsLabel,s.input.news_category_id=parseInt(s.input.news_category_id),s.input.status=parseInt(s.input.status),$(".box.box-default").hasClass("collapsed-box")&&$("[data-widget='collapse']").click(),n.hash("newsForm")})},s.deleteNews=function(n){var t=s.indexSearch(s.news,n);confirm("delete news?")&&(s.onLoad=!0,e["delete"](s.env.api+"news/"+n).success(function(e){a({message:e.message},e.status),"success"==e.status&&s.news.splice(t,1),s.onLoad=!1}))},s.formNews()}];
var scholarshipCtrl=["$http","$scope","$location","Upload","Notification",function(s,a,e,t,o){$.AdminLTE.layout.fix(),a.onEdit=!1,a.input={},a.scholarshipForm={},a.scholarships=[],a.totalScholarships=0,a.limit=20,a.after=0,a.scrollBusy=!1,a.scrollLast=!1,a.searchScholarship=function(s){a.after=0,a.scholarship=[],a.nextPage(),a.filter=s},a.nextPage=function(){a.scrollBusy=!0,s.get(a.env.api+"scholarship/scroll/"+a.after+"/"+a.limit,{params:a.filter}).success(function(s){for(var e=0;e<s.scholarships.length;e++)a.scholarships.push(s.scholarships[e]),a.scholarships[e].deadline=moment.unix(s.scholarships[e].deadline).format("MM/DD/YYYY");s.scholarships.length>0?a.after=s.scholarships[s.scholarships.length-1].id:a.scrollLast=!0,a.scrollBusy=!1})},a.slug=function(s){return s=s.replace(/[^a-zA-Z0-9\s]/g,""),s=s.toLowerCase(),s=s.replace(/\s/g,"-")},a.loadLabels=function(s){return a.labels},a.addLabel=function(e,t){s.post(a.env.api+"scholarship/"+t+"/label/"+e.id).success(function(s){return"success"==s.status})},a.removeLabel=function(e,t){return!!confirm("remove label?")&&void s["delete"](a.env.api+"scholarship/"+t+"/label/"+e.id).success(function(s){if("success"==s.status)return!0})},a.uploadCover=function(s,e){s&&(a.onProgress1=!0,t.upload({url:a.env.api+"scholarship/cover",method:"POST",data:{image:e}}).then(function(s){a.onProgress1=!1,a.input.image_cover=s.data.cover},function(s){o({message:s.message},s.status)},function(s){var e=parseInt(100*s.loaded/s.total);a.progress1=e}))},a.uploadContent=function(s,e){s&&(a.onProgress2=!0,t.upload({url:a.env.api+"scholarship/content",method:"POST",data:{image:e}}).then(function(s){a.onProgress2=!1,a.input.image_content=s.data.content},function(s){o({message:s.message},s.status)},function(s){var e=parseInt(100*s.loaded/s.total);a.progress2=e}))},a.resetScholarship=function(){a.input={},$("[data-widget='collapse']").click()},a.saveScholarship=function(e){if(a.onSave=!0,void 0==e.id)s.post(a.env.api+"scholarship",e).success(function(s){o({message:s.message},s.status),"success"==s.status&&(a.scholarships.push(s.scholarship),a.input.id=s.scholarship.id),a.onSave=!1});else{var t=a.indexSearch(a.scholarships,e.id);e.created_by=e.created_by.id,s.put(a.env.api+"scholarship/"+e.id,e).then(function(s){a.scholarships[t]=s.data.scholarship[0],o({message:s.data.message},s.data.status),a.onSave=!1})}},a.editScholarship=function(t){s.get(a.env.api+"scholarship/"+t).success(function(s){a.input=s.detail,a.input.deadline=moment.unix(s.detail.deadline).format("MM/DD/YYYY"),a.input.scholarship_degree_id=parseInt(a.input.scholarship_degree_id),a.input.status=parseInt(a.input.status),$(".box.box-default").hasClass("collapsed-box")&&$("[data-widget='collapse']").click(),e.hash("scholarshipForm")})},a.deleteScholarship=function(e){var t=a.indexSearch(a.scholarships,e);confirm("delete scholarship?")&&(a.onLoad=!0,s["delete"](a.env.api+"scholarship/"+e).success(function(s){o({message:s.message},s.status),"success"==s.status&&a.scholarships.splice(t,1),a.onLoad=!1}))}}];
var schoolCtrl=["$http","$scope","$location","Notification","Upload",function(o,s,e,t,c){$.AdminLTE.layout.fix(),s.onEdit=!1,s.input={},s.schoolAddForm={},s.schools=[],s.totalSchools=0,s.limit=20,s.after=0,s.scrollBusy=!1,s.scrollLast=!1,s.searchSchool=function(o){s.after=0,s.schools=[],s.nextPage(),s.filter=o},s.nextPage=function(){s.scrollBusy=!0,o.get(s.env.api+"school/scroll/"+s.after+"/"+s.limit,{params:s.filter}).success(function(o){for(var e=0;e<o.schools.length;e++)s.schools.push(o.schools[e]);o.schools.length>0?s.after=o.schools[o.schools.length-1].id:s.scrollLast=!0,s.scrollBusy=!1})},s.formSchool=function(){o.get(s.env.api+"school/form").success(function(o){s.schoolTypes=o.schoolTypes,s.cities=o.cities,s.provinces=o.provinces})},s.uploadLogo=function(o,e){o&&(s.onProgress1=!0,c.upload({url:s.env.api+"school/logo",method:"POST",data:{image:e}}).then(function(o){s.onProgress1=!1,s.input.logo=o.data.logo},function(o){t({message:o.message},o.status)},function(o){var e=parseInt(100*o.loaded/o.total);s.progress1=e}))},s.uploadImage=function(o,e){o&&(s.onProgress2=!0,c.upload({url:s.env.api+"school/image",method:"POST",data:{image:e}}).then(function(o){s.onProgress2=!1,s.input.image=o.data.image},function(o){t({message:o.message},o.status)},function(o){var e=parseInt(100*o.loaded/o.total);s.progress2=e}))},s.resetSchool=function(){s.input={},$("[data-widget='collapse']").click()},s.saveSchool=function(e){s.onSave=!0,void 0===e.id?o.post(s.env.api+"school",e).success(function(o){t({message:o.message},o.status),"success"==o.status&&(s.schools.push(o.school[0]),s.input.id=o.school[0].id),s.onSave=!1}):o.put(s.env.api+"school/"+e.id,e).success(function(o){t({message:o.message},o.status),s.onSave=!1})},s.editSchool=function(t){s.onEdit=!1,o.get(s.env.api+"school/"+t).success(function(o){s.input=o.detail[0],s.input.school_type_id=parseInt(s.input.school_type_id),s.input.province_id=parseInt(s.input.city.province_id),s.input.city_id=parseInt(s.input.city_id),$(".box.box-default").hasClass("collapsed-box")&&$("[data-widget='collapse']").click(),e.hash("schoolForm")})},s.deleteSchool=function(e){var c=s.indexSearch(s.schools,e);confirm("delete school?")&&(s.onLoad=!0,o["delete"](s.env.api+"school/"+e).success(function(o){t({message:o.message},o.status),"success"==o.status&&s.schools.splice(c,1),s.onLoad=!1}))},s.slug=function(o,s){return s=s.replace(/[^a-zA-Z0-9\s]/g,""),s=s.toLowerCase(),s=s.replace(/\s/g,"-"),o+"-"+s},s.formSchool()}];
var schoolTypeCtrl=["$http","$scope","Notification",function(e,s,t){$.AdminLTE.layout.fix(),s.types=[],s.totalTypes=0,s.limit=20,s.after=0,s.scrollBusy=!1,s.nextPage=function(){s.scrollBusy=!0,e.get(s.env.api+"school/type/scroll/"+s.after+"/"+s.limit,{params:s.filter}).success(function(e){for(var t=0;t<e.types.length;t++)s.types.push(e.types[t]);e.types.length>0&&(s.after=e.types[e.types.length-1].id,s.scrollBusy=!1)})},s.addType=function(o){s.onAdd=!0,e.post(s.env.api+"school/type",o).success(function(e){t({message:e.message},e.status),"success"==e.status&&(s.types.push(e.type),s.input={},$("#code").focus()),s.onAdd=!1})},s.saveType=function(t,o){s.onSave=!0,e.put(s.env.api+"school/type/"+o,t).success(function(e){return s.onSave=!1,!0})},s.deleteType=function(o){var n=s.indexSearch(s.types,o);confirm("delete type?")&&(s.onDelete=!0,e["delete"](s.env.api+"school/type/"+o).success(function(e){t({message:e.message},e.status),"success"==e.status&&s.types.splice(n,1),s.onDelete=!1}))}}];
var userCtrl=["$http","$scope","$location","Notification","Upload",function(s,e,t,u,r){$.AdminLTE.layout.fix(),e.onEdit=!1,e.input={},e.userAddForm={},e.users=[],e.totalUsers=0,e.limit=20,e.after=0,e.scrollBusy=!1,e.scrollLast=!1,e.searchUser=function(s){e.after=0,e.users=[],e.nextPage(),e.filter=s},e.nextPage=function(){e.scrollBusy=!0,s.get(e.env.api+"user/scroll/"+e.after+"/"+e.limit,{params:e.filter}).success(function(s){for(var t=0;t<s.users.length;t++)e.users.push(s.users[t]);s.users.length>0?e.after=s.users[s.users.length-1].id:e.scrollLast=!0,e.scrollBusy=!1})},e.formUser=function(){s.get(e.env.api+"user/form").success(function(s){e.roles=s.roles})},e.uploadPicture=function(s,t){s&&(e.onProgress2=!0,r.upload({url:e.env.api+"user/picture",method:"POST",data:{picture:t}}).then(function(s){e.onProgress2=!1,e.input.picture=s.data.picture},function(s){u({message:s.message},s.status)},function(s){var t=parseInt(100*s.loaded/s.total);e.progress2=t}))},e.resetUser=function(){e.input={},$("[data-widget='collapse']").click()},e.saveUser=function(t){return e.onSave=!0,void 0!==t.id?s.put(e.env.api+"user/"+t.id,t).then(function(s){200==s.status?(u({message:"user data updated"},"success"),e.input={},$("[data-widget='collapse']").click()):500==s.status&&u({message:"failed to update"},"error"),e.onSave=!0}):void s.post(e.env.api+"user",t).success(function(s){u({message:s.message},s.status),"success"==s.status&&(e.users.push(s.user),e.input={}),e.onSave=!0})},e.editUser=function(u){e.onEdit=!1,s.get(e.env.api+"user/"+u).success(function(s){e.input.role_id=parseInt(s.user.roles[0].id),e.input.id=s.user.id,e.input.name=s.user.name,e.input.email=s.user.email,$(".box.box-default").hasClass("collapsed-box")&&$("[data-widget='collapse']").click(),t.hash("userForm")})},e.deleteUser=function(t){var r=e.indexSearch(e.users,t);confirm("delete user?")&&(e.onLoad=!0,s["delete"](e.env.api+"user/"+t).success(function(s){u({message:s.message},s.status),"success"==s.status&&e.users.splice(r,1),e.onLoad=!1}))},e.formUser()}];
app=angular.module("kisiApp",["ui.router","satellizer","ngTouch","superswipe","angularUtils.directives.dirPagination","xeditable","environment","ui-notification","ngFileUpload","ngTagsInput","toggle-switch","textAngular","infinite-scroll","validation.match"]),app.run(["editableOptions","editableThemes",function(l,t){t.bs3.inputClass="ui input",t.bs3.buttonsClass="ui button",l.theme="bs3"}]).config(config).controller("kisiCtrl",kisiCtrl).controller("homeCtrl",homeCtrl).controller("authCtrl",authCtrl).controller("labelCtrl",labelCtrl).controller("schoolTypeCtrl",schoolTypeCtrl).controller("schoolCtrl",schoolCtrl).controller("newsCtrl",newsCtrl).controller("newsCatCtrl",newsCatCtrl).controller("agendaCtrl",agendaCtrl).controller("agendaCatCtrl",agendaCatCtrl).controller("scholarshipCtrl",scholarshipCtrl).controller("courseCtrl",courseCtrl).controller("userCtrl",userCtrl).directive("datepicker",function(){return function(l,t,r){$(t).datepicker()}});
function _init(){"use strict";$.AdminLTE.layout={activate:function(){var e=this;e.fix(),e.fixSidebar(),$(window,".wrapper").resize(function(){e.fix(),e.fixSidebar()})},fix:function(){var e=$(".main-header").outerHeight()+$(".main-footer").outerHeight(),i=$(window).height(),o=$(".sidebar").height();if($("body").hasClass("fixed"))$(".content-wrapper, .right-side").css("min-height",i-$(".main-footer").outerHeight());else{var n;i>=o?($(".content-wrapper, .right-side").css("min-height",i-e),n=i-e):($(".content-wrapper, .right-side").css("min-height",o),n=o);var t=$($.AdminLTE.options.controlSidebarOptions.selector);"undefined"!=typeof t&&t.height()>n&&$(".content-wrapper, .right-side").css("min-height",t.height())}},fixSidebar:function(){return $("body").hasClass("fixed")?("undefined"==typeof $.fn.slimScroll&&window.console&&window.console.error("Error: the fixed layout requires the slimscroll plugin!"),void($.AdminLTE.options.sidebarSlimScroll&&"undefined"!=typeof $.fn.slimScroll&&($(".sidebar").slimScroll({destroy:!0}).height("auto"),$(".sidebar").slimscroll({height:$(window).height()-$(".main-header").height()+"px",color:"rgba(0,0,0,0.2)",size:"3px"})))):void("undefined"!=typeof $.fn.slimScroll&&$(".sidebar").slimScroll({destroy:!0}).height("auto"))}},$.AdminLTE.pushMenu={activate:function(e){var i=$.AdminLTE.options.screenSizes;$(document).on("click",e,function(e){e.preventDefault(),$(window).width()>i.sm-1?$("body").hasClass("sidebar-collapse")?$("body").removeClass("sidebar-collapse").trigger("expanded.pushMenu"):$("body").addClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").hasClass("sidebar-open")?$("body").removeClass("sidebar-open").removeClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").addClass("sidebar-open").trigger("expanded.pushMenu")}),$(".content-wrapper").click(function(){$(window).width()<=i.sm-1&&$("body").hasClass("sidebar-open")&&$("body").removeClass("sidebar-open")}),($.AdminLTE.options.sidebarExpandOnHover||$("body").hasClass("fixed")&&$("body").hasClass("sidebar-mini"))&&this.expandOnHover()},expandOnHover:function(){var e=this,i=$.AdminLTE.options.screenSizes.sm-1;$(".main-sidebar").hover(function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-collapse")&&$(window).width()>i&&e.expand()},function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-expanded-on-hover")&&$(window).width()>i&&e.collapse()})},expand:function(){$("body").removeClass("sidebar-collapse").addClass("sidebar-expanded-on-hover")},collapse:function(){$("body").hasClass("sidebar-expanded-on-hover")&&$("body").removeClass("sidebar-expanded-on-hover").addClass("sidebar-collapse")}},$.AdminLTE.tree=function(e){var i=this,o=$.AdminLTE.options.animationSpeed;$(document).off("click",e+" li a").on("click",e+" li a",function(e){var n=$(this),t=n.next();if(t.is(".treeview-menu")&&t.is(":visible")&&!$("body").hasClass("sidebar-collapse"))t.slideUp(o,function(){t.removeClass("menu-open")}),t.parent("li").removeClass("active");else if(t.is(".treeview-menu")&&!t.is(":visible")){var s=n.parents("ul").first(),a=s.find("ul:visible").slideUp(o);a.removeClass("menu-open");var r=n.parent("li");t.slideDown(o,function(){t.addClass("menu-open"),s.find("li.active").removeClass("active"),r.addClass("active"),i.layout.fix()})}t.is(".treeview-menu")&&e.preventDefault()})},$.AdminLTE.controlSidebar={activate:function(){var e=this,i=$.AdminLTE.options.controlSidebarOptions,o=$(i.selector),n=$(i.toggleBtnSelector);n.on("click",function(n){n.preventDefault(),o.hasClass("control-sidebar-open")||$("body").hasClass("control-sidebar-open")?e.close(o,i.slide):e.open(o,i.slide)});var t=$(".control-sidebar-bg");e._fix(t),$("body").hasClass("fixed")?e._fixForFixed(o):$(".content-wrapper, .right-side").height()<o.height()&&e._fixForContent(o)},open:function(e,i){i?e.addClass("control-sidebar-open"):$("body").addClass("control-sidebar-open")},close:function(e,i){i?e.removeClass("control-sidebar-open"):$("body").removeClass("control-sidebar-open")},_fix:function(e){var i=this;if($("body").hasClass("layout-boxed")){if(e.css("position","absolute"),e.height($(".wrapper").height()),i.hasBindedResize)return;$(window).resize(function(){i._fix(e)}),i.hasBindedResize=!0}else e.css({position:"fixed",height:"auto"})},_fixForFixed:function(e){e.css({position:"fixed","max-height":"100%",overflow:"auto","padding-bottom":"50px"})},_fixForContent:function(e){$(".content-wrapper, .right-side").css("min-height",e.height())}},$.AdminLTE.boxWidget={selectors:$.AdminLTE.options.boxWidgetOptions.boxWidgetSelectors,icons:$.AdminLTE.options.boxWidgetOptions.boxWidgetIcons,animationSpeed:$.AdminLTE.options.animationSpeed,activate:function(e){var i=this;e||(e=document),$(e).on("click",i.selectors.collapse,function(e){e.preventDefault(),i.collapse($(this))}),$(e).on("click",i.selectors.remove,function(e){e.preventDefault(),i.remove($(this))})},collapse:function(e){var i=this,o=e.parents(".box").first(),n=o.find("> .box-body, > .box-footer, > form  >.box-body, > form > .box-footer");o.hasClass("collapsed-box")?(e.children(":first").removeClass(i.icons.open).addClass(i.icons.collapse),n.slideDown(i.animationSpeed,function(){o.removeClass("collapsed-box")})):(e.children(":first").removeClass(i.icons.collapse).addClass(i.icons.open),n.slideUp(i.animationSpeed,function(){o.addClass("collapsed-box")}))},remove:function(e){var i=e.parents(".box").first();i.slideUp(this.animationSpeed)}}}if("undefined"==typeof jQuery)throw new Error("AdminLTE requires jQuery");$.AdminLTE={},$.AdminLTE.options={navbarMenuSlimscroll:!0,navbarMenuSlimscrollWidth:"3px",navbarMenuHeight:"200px",animationSpeed:500,sidebarToggleSelector:"[data-toggle='offcanvas']",sidebarPushMenu:!0,sidebarSlimScroll:!0,sidebarExpandOnHover:!1,enableBoxRefresh:!0,enableBSToppltip:!0,BSTooltipSelector:"[data-toggle='tooltip']",enableFastclick:!1,enableControlSidebar:!0,controlSidebarOptions:{toggleBtnSelector:"[data-toggle='control-sidebar']",selector:".control-sidebar",slide:!0},enableBoxWidget:!0,boxWidgetOptions:{boxWidgetIcons:{collapse:"fa-minus",open:"fa-plus",remove:"fa-times"},boxWidgetSelectors:{remove:'[data-widget="remove"]',collapse:'[data-widget="collapse"]'}},directChat:{enable:!0,contactToggleSelector:'[data-widget="chat-pane-toggle"]'},colors:{lightBlue:"#3c8dbc",red:"#f56954",green:"#00a65a",aqua:"#00c0ef",yellow:"#f39c12",blue:"#0073b7",navy:"#001F3F",teal:"#39CCCC",olive:"#3D9970",lime:"#01FF70",orange:"#FF851B",fuchsia:"#F012BE",purple:"#8E24AA",maroon:"#D81B60",black:"#222222",gray:"#d2d6de"},screenSizes:{xs:480,sm:768,md:992,lg:1200}},$(function(){"use strict";$("body").removeClass("hold-transition"),"undefined"!=typeof AdminLTEOptions&&$.extend(!0,$.AdminLTE.options,AdminLTEOptions);var e=$.AdminLTE.options;_init(),$.AdminLTE.layout.activate(),$.AdminLTE.tree(".sidebar"),e.enableControlSidebar&&$.AdminLTE.controlSidebar.activate(),e.navbarMenuSlimscroll&&"undefined"!=typeof $.fn.slimscroll&&$(".navbar .menu").slimscroll({height:e.navbarMenuHeight,alwaysVisible:!1,size:e.navbarMenuSlimscrollWidth}).css("width","100%"),e.sidebarPushMenu&&$.AdminLTE.pushMenu.activate(e.sidebarToggleSelector),e.enableBSToppltip&&$("body").tooltip({selector:e.BSTooltipSelector}),e.enableBoxWidget&&$.AdminLTE.boxWidget.activate(),e.enableFastclick&&"undefined"!=typeof FastClick&&FastClick.attach(document.body),e.directChat.enable&&$(document).on("click",e.directChat.contactToggleSelector,function(){var e=$(this).parents(".direct-chat").first();e.toggleClass("direct-chat-contacts-open")}),$('.btn-group[data-toggle="btn-toggle"]').each(function(){var e=$(this);$(this).find(".btn").on("click",function(i){e.find(".btn.active").removeClass("active"),$(this).addClass("active"),i.preventDefault()})})}),function(e){"use strict";e.fn.boxRefresh=function(i){function o(e){e.append(s),t.onLoadStart.call(e)}function n(e){e.find(s).remove(),t.onLoadDone.call(e)}var t=e.extend({trigger:".refresh-btn",source:"",onLoadStart:function(e){return e},onLoadDone:function(e){return e}},i),s=e('<div class="overlay"><div class="fa fa-refresh fa-spin"></div></div>');return this.each(function(){if(""===t.source)return void(window.console&&window.console.log("Please specify a source first - boxRefresh()"));var i=e(this),s=i.find(t.trigger).first();s.on("click",function(e){e.preventDefault(),o(i),i.find(".box-body").load(t.source,function(){n(i)})})})}}(jQuery),function(e){"use strict";e.fn.activateBox=function(){e.AdminLTE.boxWidget.activate(this)},e.fn.toggleBox=function(){var i=e(e.AdminLTE.boxWidget.selectors.collapse,this);e.AdminLTE.boxWidget.collapse(i)},e.fn.removeBox=function(){var i=e(e.AdminLTE.boxWidget.selectors.remove,this);e.AdminLTE.boxWidget.remove(i)}}(jQuery),function(e){"use strict";e.fn.todolist=function(i){var o=e.extend({onCheck:function(e){return e},onUncheck:function(e){return e}},i);return this.each(function(){"undefined"!=typeof e.fn.iCheck?(e("input",this).on("ifChecked",function(){var i=e(this).parents("li").first();i.toggleClass("done"),o.onCheck.call(i)}),e("input",this).on("ifUnchecked",function(){var i=e(this).parents("li").first();i.toggleClass("done"),o.onUncheck.call(i)})):e("input",this).on("change",function(){var i=e(this).parents("li").first();i.toggleClass("done"),e("input",i).is(":checked")?o.onCheck.call(i):o.onUncheck.call(i)})})}}(jQuery);
